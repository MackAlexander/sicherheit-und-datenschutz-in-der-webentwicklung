# THM Security Plugin

> [!TIP]
> **🔍 Beschreibung**
> 
> Dieses Plugin verbessert die **Sicherheit Ihrer WordPress-Website**, indem es Benutzernamen in öffentlichen Bereichen verbirgt und unerwünschte Anfragen überwacht und blockiert. Dies schützt Ihre Website vor Brute-Force-Angriffen und anderen potenziellen Sicherheitsrisiken.

> [!NOTE] 
> **🚀 Mehrwert**
> 
> Durch die Installation dieses Plugins verhindern Sie, dass Angreifer Benutzernamen auf Ihrer Website abfragen und möglicherweise Passwörter knacken können. Außerdem sorgt das Plugin dafür, dass unerwünschte Anfragen von **Plugins** und **Themes** mit Sicherheitslücken automatisch **erkannt** und **blockiert** werden, was die Sicherheit Ihrer Website erhöht.

> [!NOTE] 
> **🚧 Abgrenzung**
> #### Dieses Plugin:
> - ist nur für WordPress geeignet
> - protokolliert nur bösartige Requests
> - trackt nur Requests zum Schutz vor bekannten Wordpress Themes und Plugins mit Sicherheitslücken
> - garantiert nicht, dass neue Sicherheitslücken sofort oder überhaupt geschlossen werden
> - ist **NICHT** geeignet, für einen vollständigen Schutz vor Hackern geeignet

#
> [!WARNING]
>
>  **🔒 Datenschutzinformationen für den Endanwender**
>
>    ### Übersicht:
>    **1**. Beschreibt, welche Daten das Plugins sammelt.
> 
>    **2**. Beschreibt, warum das Plugin diese Daten benötigt.
> 
>    **3**. Beschreibt, was das Plugin macht mit diesen Daten macht.
> 
>    **4**. Beschreibt, ob die gesammelten Daten personenbezogen sind.
> 
>    - ###### Kurze Zusammenfassung des Stichpunkts.

> [!IMPORTANT]
> **🌐 IP-Adressen**
> 
>    **1**. Diese Daten werden gesammelt, um potenziell unerwünschte oder schädliche Anfragen zu identifizieren und zu blockieren.
> 
>    **2**. Dies gewährleistet die Sicherheit der Anwendung und schädliche Aktivitäten werden verhindert.
> 
>    **3**. Das Plugin nutzt diese Daten, um IP-Adressen zu blockieren und den Zugriff auf die Anwendungen auf Ihrer Website zu sichern.
> 
>    **4**. Es handelt sich hierbei um personenbezogene Daten nach DSGVO.
> 
>    - ###### Kurz: Das Plugin benötigt werden diese Daten, um die Sicherheit der Anwendung zu gewährleisten und schädliche Aktivitäten zu verhindern.

> [!IMPORTANT]
> **⏱️ Zeit der Anfrage**
> 
>    **1**. Zeitstempel der Abfragen werden erfasst, um Muster zu erkennen und mögliche Missbrauchsversuche zu analysieren.
> 
>    **2**. Dies wird vom Plugin verwendet, um die Nutzungsmuster zu analysieren und die Leistung der Anwendung zu optimieren.
> 
>    **3**. Das Plugin nutzt diese Informationen zur Analyse von Nutzungsmustern und zur Leistungsoptimierung.
> 
>    **4**. Der Zeitstempel der Anfrage ist keine personenbezogene Information.
> 
>    - ###### Kurz: Zeitstempel der Anfragen werden erfasst, um Angriffsmuster zu erkennen und die Anwendung zu optimieren (keine personenbezogenen Daten).

> [!IMPORTANT]
> **🧭 URL der Anfrage**
> 
>    **1**. Die URL der Anfrage wird gesammelt, um zu überprüfen, welche Seiten oder Ressourcen aufgerufen werden und ob diese Anfragen legitim sind.
> 
>    **2**. Um sicherzustellen, dass die aufgerufenen Ressourcen korrekt und sicher sind, wird vom Plugin die URL Anfragen gesammelt.
> 
>    **3**. Diese Daten werden genutzt, um die Legitimität der Anfragen zu prüfen und sicherzustellen, dass keine unbefugten Zugriffe stattfinden.
> 
>    **4**. Die URL kann personenbezogene Daten enthalten, z.B. Nutzernamen oder Profilinformationen.
> 
>    - ###### Kurz: Die URL der Anfrage wird gesammelt, um die Legitimität der Anfragen zu prüfen und Sicherheitsrisiken zu minimieren (möglicherweise personenbezogene Daten enthalten).

> [!IMPORTANT]
> **📄 POST-Daten**
> 
>    **1**. POST-Daten können Formularinhalte oder Login-Daten enthalten, die zur Authentifizierung und Verarbeitung der Benutzeranfragen benötigt werden.
> 
>    **2**. Zur Verarbeitung von Formularen und Authentifizierungsanfragen werden diese Daten benötigt.
> 
>    **3**. Diese Daten werden zur Authentifizierung und Verarbeitung von Benutzeranfragen verwendet.
> 
>    **4**. POST-Daten können personenbezogene Informationen enthalten, z.B. Formularinhalte oder Login-Daten.
> 
>    - ###### Kurz: POST-Daten (Formulare, Login-Daten) werden für die Authentifizierung und Benutzeranfragen verarbeitet (möglicherweise personenbezogene Daten).

> [!IMPORTANT]
> **🌐 HTTP/1.1**
> 
>    **1**. Das HTTP-Protokoll selbst enthält keine personenbezogenen Daten, wird aber zur Verarbeitung der Anfragen verwendet.
> 
>    **2**. Zur Abwicklung der Kommunikation zwischen Server und Client werden diese Daten benötigt.
> 
>    **3**. Diese Informationen werden zur Verwaltung der Kommunikation zwischen Server und Client genutzt.
> 
>    **4**. Das HTTP-Protokoll enthält keine personenbezogenen Daten.
> 
>    - ###### Kurz: Das HTTP-Protokoll selbst ist datenneutral, wird aber für die Verarbeitung von Anfragen verwendet, die personenbezogene Daten enthalten können.

> [!IMPORTANT]
> **🧵 Query-String**
> 
>    **1**. Der Query-String kann Suchparameter oder Filterkriterien enthalten, die zur Verarbeitung und Beantwortung der Benutzeranfragen genutzt werden.
> 
>    **2**. Zur Verarbeitung und Filterung von Suchanfragen und anderen Parametern werden diese Daten benötigt.
> 
>    **3**. Diese Daten werden zur Bearbeitung und Beantwortung von Benutzeranfragen verwendet.
> 
>    **4**. Der Query-String kann personenbezogene Daten enthalten, z.B. Suchparameter oder Filterkriterien.
> 
>    - ###### Kurz: Der Query-String (Suchparameter, Filterkriterien) wird zur Verarbeitung und Beantwortung von Anfragen genutzt und kann personenbezogene Daten enthalten.

> [!IMPORTANT]
> **🆔 User ID**
> 
>    **1**. Wenn verfügbar, wird die User ID gesammelt, um Benutzeranfragen zuzuordnen und Benutzersitzungen zu verwalten.
> 
>    **2**. Zur Verwaltung der Benutzersitzungen und Personalisierung der Benutzererfahrung werden diese Daten benötigt.
> 
>    **3**. Diese Daten werden zur Verwaltung der Benutzersitzungen und Personalisierung der Benutzererfahrung genutzt.
> 
>    **4**. Es handelt sich um personenbezogen Daten (DSGVO relevant).
> 
>    - ###### Kurz: Das Plugin sammelt datenschutzrelevante Daten, um Benutzeranfragen zuzuordnen und zu verwalten, wobei es sich um personenbezogene Daten handelt.

> [!IMPORTANT]
> **🧑‍💻 User-Agent**
> 
>    **1**. Der User-Agent wird gesammelt, um das verwendete Gerät und den Browser zu identifizieren, was zur Verbesserung der Kompatibilität und Sicherheit der Anwendung beiträgt.
> 
>    **2**. Zur Verbesserung der Kompatibilität und Sicherheit der Anwendung werden diese Daten benötigt.
> 
>    **3**. Diese Informationen werden zur Verbesserung der Kompatibilität und Sicherheit der Anwendung genutzt.
> 
>    **4**. Die Speicherung des User-Agents ist nicht DSGVO-widrig, da die gesammelten User-Agent-Daten nicht mit anderen Daten kombiniert, um auf den Nutzer zu schließen, oder zu Trackingzwecken eingesetzt werden.
> 
>    - ###### Kurz: Die Sammlung des User-Agents zur Verbesserung der Kompatibilität und Sicherheit ist DSGVO-konform, solange die Daten zweckgebunden, minimiert und nicht für Trackingzwecke verwendet werden. Bedenken Sie die Anonymisierung/Pseudonymisierung zum Datenschutz.

> [!IMPORTANT]
> **💬 Anfragen**
> 
>    **1**. Alle Anfragen werden analysiert, um schädliche Aktivitäten zu erkennen und zu verhindern.
> 
>    **2**. Zur Identifizierung und Verhinderung von schädlichen Aktivitäten werden diese Daten benötigt.
> 
>    **3**. Diese Daten werden zur Analyse und Verhinderung von schädlichen Aktivitäten verwendet.
> 
>    **4**. Um zu analysieren, welche Anfragen schädlich sein könnten.
> 
>    - ###### Kurz: zur Analyse werden, all diese DSGVO konformen Anfragen werden auf schädliche Aktivitäten geprüft.
#
#
> [!Warning]
> **❓ Warum braucht es diese Daten?**
>    - Diese Daten sind notwendig, um die Website vor Angriffen zu schützen und sicherzustellen, dass nur legitime Anfragen zugelassen werden.

> [!Warning]
> **🛠️ Was macht das Plugin mit diesen Daten?**
>    - **Analyse:** Die gesammelten Daten werden analysiert, um schädliche Muster zu erkennen.
>    - **Blockierung:** IP-Adressen, die schädliche Anfragen senden, werden blockiert.

> [!Warning]
> **⏳ Wie lange werden die Daten gespeichert?**
>    - Die Daten werden für maximal **30 Tage** gespeichert und danach automatisch gelöscht.
>    - Durch das Deaktivieren oder das Löschen dieses WordPress-Plugins werden alle personenbezogene Daten gelöscht, indem das Plugin die gesamten Tabellen löscht, welche personenbezogene Daten enthalten.

> [!Warning]
> **🗑️ Was passiert danach mit den Daten?**
> - Nach Ablauf der Speicherfrist werden die Daten **sicher gelöscht**, sodass sie nicht mehr auf Einzelpersonen zurückgeführt werden können. Dies stellt sicher, dass keine unnötigen personenbezogenen Daten gespeichert werden und die Privatsphäre der Benutzer gewahrt bleibt.

> [!Warning]
> **🔒 Datenschutzerklärung**
>    - Dieses Plugin sammelt IP-Adressen und Anfragen, um die Sicherheit der Website zu gewährleisten. Die gesammelten Daten werden nur für diesen Zweck verwendet und nach 30 Tagen gelöscht.
#
#
## Hinweise zur Nutzung des Plugins

> [!Note]
> **📦 Installation**
>    - Lade das Plugin in dein WordPress-Verzeichnis hoch (/wp-content/plugins/).
>    - **Aktiviere** das Plugin im WordPress-Adminbereich unter **Plugins**.
>         - Konfiguration: **Keine** weitere Konfiguration nötig – Es gewährleistet die Sicherheit Ihrer Daten.

> [!Note]
> **💡 Hinweise**
>    - Sie werden im Admin-Bereich benachrichtigt, wenn ein Benutzername mit einem angezeigten Namen übereinstimmt, um Sie auf potenzielle Sicherheitsrisiken hinzuweisen.
    Blockierte IPs werden nach einem bestimmten Zeitraum automatisch wieder freigegeben.
#
#
## Technische Details
> [!Note]
> **📊 Tabellen in der Datenbank**
>   - Das Plugin erstellt zusätzliche Tabellen in der WordPress-Datenbank
#
#   
> [!Important]
> **⚓ Hooks und Filter**
>
>    - shutdown: Wird ausgeführt, unmittelbar bevor PHP die Ausführung beendet. Überprüft und blendet Benutzernamen aus.
>    - Dieser Hook wird von  shutdown_action_hook() aufgerufen und von register_shutdown_function()  in  als Shutdown-Funktion bei PHP registriert wp-settings.php.
>    - rest_prepare_user: Entfernt Benutzernamen aus REST API Antworten.
>    - template_redirect: Deaktiviert URLs, die Benutzernamen enthalten.

> [!Note]
> **🧩 Links zu den Modulen**
>
>    🔗[username-enumeration.md](docs/username-enumeration.md)
> 
>    🔗[badrequest-tracker.md](docs/badrequest-tracker.md)
