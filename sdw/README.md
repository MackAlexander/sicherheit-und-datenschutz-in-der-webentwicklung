# THM Security Plugin

> [!TIP]
> **ğŸ” Beschreibung**
> 
> Dieses Plugin verbessert die **Sicherheit Ihrer WordPress-Website**, indem es Benutzernamen in Ã¶ffentlichen Bereichen verbirgt und unerwÃ¼nschte Anfragen Ã¼berwacht und blockiert. Dies schÃ¼tzt Ihre Website vor Brute-Force-Angriffen und anderen potenziellen Sicherheitsrisiken.

> [!NOTE] 
> **ğŸš€ Mehrwert**
> 
> Durch die Installation dieses Plugins verhindern Sie, dass Angreifer Benutzernamen auf Ihrer Website abfragen und mÃ¶glicherweise PasswÃ¶rter knacken kÃ¶nnen. AuÃŸerdem sorgt das Plugin dafÃ¼r, dass unerwÃ¼nschte Anfragen von **Plugins** und **Themes** mit SicherheitslÃ¼cken automatisch **erkannt** und **blockiert** werden, was die Sicherheit Ihrer Website erhÃ¶ht.

> [!NOTE] 
> **ğŸš§ Abgrenzung**
> #### Dieses Plugin:
> - ist nur fÃ¼r WordPress geeignet
> - protokolliert nur bÃ¶sartige Requests
> - trackt nur Requests zum Schutz vor bekannten Wordpress Themes und Plugins mit SicherheitslÃ¼cken
> - garantiert nicht, dass neue SicherheitslÃ¼cken sofort oder Ã¼berhaupt geschlossen werden
> - ist **NICHT** geeignet, fÃ¼r einen vollstÃ¤ndigen Schutz vor Hackern geeignet

#
> [!WARNING]
>
>  **ğŸ”’ Datenschutzinformationen fÃ¼r den Endanwender**
>
>    ### Ãœbersicht:
>    **1**. Beschreibt, welche Daten das Plugins sammelt.
> 
>    **2**. Beschreibt, warum das Plugin diese Daten benÃ¶tigt.
> 
>    **3**. Beschreibt, was das Plugin macht mit diesen Daten macht.
> 
>    **4**. Beschreibt, ob die gesammelten Daten personenbezogen sind.
> 
>    - ###### Kurze Zusammenfassung des Stichpunkts.

> [!IMPORTANT]
> **ğŸŒ IP-Adressen**
> 
>    **1**. Diese Daten werden gesammelt, um potenziell unerwÃ¼nschte oder schÃ¤dliche Anfragen zu identifizieren und zu blockieren.
> 
>    **2**. Dies gewÃ¤hrleistet die Sicherheit der Anwendung und schÃ¤dliche AktivitÃ¤ten werden verhindert.
> 
>    **3**. Das Plugin nutzt diese Daten, um IP-Adressen zu blockieren und den Zugriff auf die Anwendungen auf Ihrer Website zu sichern.
> 
>    **4**. Es handelt sich hierbei um personenbezogene Daten nach DSGVO.
> 
>    - ###### Kurz: Das Plugin benÃ¶tigt werden diese Daten, um die Sicherheit der Anwendung zu gewÃ¤hrleisten und schÃ¤dliche AktivitÃ¤ten zu verhindern.

> [!IMPORTANT]
> **â±ï¸ Zeit der Anfrage**
> 
>    **1**. Zeitstempel der Abfragen werden erfasst, um Muster zu erkennen und mÃ¶gliche Missbrauchsversuche zu analysieren.
> 
>    **2**. Dies wird vom Plugin verwendet, um die Nutzungsmuster zu analysieren und die Leistung der Anwendung zu optimieren.
> 
>    **3**. Das Plugin nutzt diese Informationen zur Analyse von Nutzungsmustern und zur Leistungsoptimierung.
> 
>    **4**. Der Zeitstempel der Anfrage ist keine personenbezogene Information.
> 
>    - ###### Kurz: Zeitstempel der Anfragen werden erfasst, um Angriffsmuster zu erkennen und die Anwendung zu optimieren (keine personenbezogenen Daten).

> [!IMPORTANT]
> **ğŸ§­ URL der Anfrage**
> 
>    **1**. Die URL der Anfrage wird gesammelt, um zu Ã¼berprÃ¼fen, welche Seiten oder Ressourcen aufgerufen werden und ob diese Anfragen legitim sind.
> 
>    **2**. Um sicherzustellen, dass die aufgerufenen Ressourcen korrekt und sicher sind, wird vom Plugin die URL Anfragen gesammelt.
> 
>    **3**. Diese Daten werden genutzt, um die LegitimitÃ¤t der Anfragen zu prÃ¼fen und sicherzustellen, dass keine unbefugten Zugriffe stattfinden.
> 
>    **4**. Die URL kann personenbezogene Daten enthalten, z.B. Nutzernamen oder Profilinformationen.
> 
>    - ###### Kurz: Die URL der Anfrage wird gesammelt, um die LegitimitÃ¤t der Anfragen zu prÃ¼fen und Sicherheitsrisiken zu minimieren (mÃ¶glicherweise personenbezogene Daten enthalten).

> [!IMPORTANT]
> **ğŸ“„ POST-Daten**
> 
>    **1**. POST-Daten kÃ¶nnen Formularinhalte oder Login-Daten enthalten, die zur Authentifizierung und Verarbeitung der Benutzeranfragen benÃ¶tigt werden.
> 
>    **2**. Zur Verarbeitung von Formularen und Authentifizierungsanfragen werden diese Daten benÃ¶tigt.
> 
>    **3**. Diese Daten werden zur Authentifizierung und Verarbeitung von Benutzeranfragen verwendet.
> 
>    **4**. POST-Daten kÃ¶nnen personenbezogene Informationen enthalten, z.B. Formularinhalte oder Login-Daten.
> 
>    - ###### Kurz: POST-Daten (Formulare, Login-Daten) werden fÃ¼r die Authentifizierung und Benutzeranfragen verarbeitet (mÃ¶glicherweise personenbezogene Daten).

> [!IMPORTANT]
> **ğŸŒ HTTP/1.1**
> 
>    **1**. Das HTTP-Protokoll selbst enthÃ¤lt keine personenbezogenen Daten, wird aber zur Verarbeitung der Anfragen verwendet.
> 
>    **2**. Zur Abwicklung der Kommunikation zwischen Server und Client werden diese Daten benÃ¶tigt.
> 
>    **3**. Diese Informationen werden zur Verwaltung der Kommunikation zwischen Server und Client genutzt.
> 
>    **4**. Das HTTP-Protokoll enthÃ¤lt keine personenbezogenen Daten.
> 
>    - ###### Kurz: Das HTTP-Protokoll selbst ist datenneutral, wird aber fÃ¼r die Verarbeitung von Anfragen verwendet, die personenbezogene Daten enthalten kÃ¶nnen.

> [!IMPORTANT]
> **ğŸ§µ Query-String**
> 
>    **1**. Der Query-String kann Suchparameter oder Filterkriterien enthalten, die zur Verarbeitung und Beantwortung der Benutzeranfragen genutzt werden.
> 
>    **2**. Zur Verarbeitung und Filterung von Suchanfragen und anderen Parametern werden diese Daten benÃ¶tigt.
> 
>    **3**. Diese Daten werden zur Bearbeitung und Beantwortung von Benutzeranfragen verwendet.
> 
>    **4**. Der Query-String kann personenbezogene Daten enthalten, z.B. Suchparameter oder Filterkriterien.
> 
>    - ###### Kurz: Der Query-String (Suchparameter, Filterkriterien) wird zur Verarbeitung und Beantwortung von Anfragen genutzt und kann personenbezogene Daten enthalten.

> [!IMPORTANT]
> **ğŸ†” User ID**
> 
>    **1**. Wenn verfÃ¼gbar, wird die User ID gesammelt, um Benutzeranfragen zuzuordnen und Benutzersitzungen zu verwalten.
> 
>    **2**. Zur Verwaltung der Benutzersitzungen und Personalisierung der Benutzererfahrung werden diese Daten benÃ¶tigt.
> 
>    **3**. Diese Daten werden zur Verwaltung der Benutzersitzungen und Personalisierung der Benutzererfahrung genutzt.
> 
>    **4**. Es handelt sich um personenbezogen Daten (DSGVO relevant).
> 
>    - ###### Kurz: Das Plugin sammelt datenschutzrelevante Daten, um Benutzeranfragen zuzuordnen und zu verwalten, wobei es sich um personenbezogene Daten handelt.

> [!IMPORTANT]
> **ğŸ§‘â€ğŸ’» User-Agent**
> 
>    **1**. Der User-Agent wird gesammelt, um das verwendete GerÃ¤t und den Browser zu identifizieren, was zur Verbesserung der KompatibilitÃ¤t und Sicherheit der Anwendung beitrÃ¤gt.
> 
>    **2**. Zur Verbesserung der KompatibilitÃ¤t und Sicherheit der Anwendung werden diese Daten benÃ¶tigt.
> 
>    **3**. Diese Informationen werden zur Verbesserung der KompatibilitÃ¤t und Sicherheit der Anwendung genutzt.
> 
>    **4**. Die Speicherung des User-Agents ist nicht DSGVO-widrig, da die gesammelten User-Agent-Daten nicht mit anderen Daten kombiniert, um auf den Nutzer zu schlieÃŸen, oder zu Trackingzwecken eingesetzt werden.
> 
>    - ###### Kurz: Die Sammlung des User-Agents zur Verbesserung der KompatibilitÃ¤t und Sicherheit ist DSGVO-konform, solange die Daten zweckgebunden, minimiert und nicht fÃ¼r Trackingzwecke verwendet werden. Bedenken Sie die Anonymisierung/Pseudonymisierung zum Datenschutz.

> [!IMPORTANT]
> **ğŸ’¬ Anfragen**
> 
>    **1**. Alle Anfragen werden analysiert, um schÃ¤dliche AktivitÃ¤ten zu erkennen und zu verhindern.
> 
>    **2**. Zur Identifizierung und Verhinderung von schÃ¤dlichen AktivitÃ¤ten werden diese Daten benÃ¶tigt.
> 
>    **3**. Diese Daten werden zur Analyse und Verhinderung von schÃ¤dlichen AktivitÃ¤ten verwendet.
> 
>    **4**. Um zu analysieren, welche Anfragen schÃ¤dlich sein kÃ¶nnten.
> 
>    - ###### Kurz: zur Analyse werden, all diese DSGVO konformen Anfragen werden auf schÃ¤dliche AktivitÃ¤ten geprÃ¼ft.
#
#
> [!Warning]
> **â“ Warum braucht es diese Daten?**
>    - Diese Daten sind notwendig, um die Website vor Angriffen zu schÃ¼tzen und sicherzustellen, dass nur legitime Anfragen zugelassen werden.

> [!Warning]
> **ğŸ› ï¸ Was macht das Plugin mit diesen Daten?**
>    - **Analyse:** Die gesammelten Daten werden analysiert, um schÃ¤dliche Muster zu erkennen.
>    - **Blockierung:** IP-Adressen, die schÃ¤dliche Anfragen senden, werden blockiert.

> [!Warning]
> **â³ Wie lange werden die Daten gespeichert?**
>    - Die Daten werden fÃ¼r maximal **30 Tage** gespeichert und danach automatisch gelÃ¶scht.
>    - Durch das Deaktivieren oder das LÃ¶schen dieses WordPress-Plugins werden alle personenbezogene Daten gelÃ¶scht, indem das Plugin die gesamten Tabellen lÃ¶scht, welche personenbezogene Daten enthalten.

> [!Warning]
> **ğŸ—‘ï¸ Was passiert danach mit den Daten?**
> - Nach Ablauf der Speicherfrist werden die Daten **sicher gelÃ¶scht**, sodass sie nicht mehr auf Einzelpersonen zurÃ¼ckgefÃ¼hrt werden kÃ¶nnen. Dies stellt sicher, dass keine unnÃ¶tigen personenbezogenen Daten gespeichert werden und die PrivatsphÃ¤re der Benutzer gewahrt bleibt.

> [!Warning]
> **ğŸ”’ DatenschutzerklÃ¤rung**
>    - Dieses Plugin sammelt IP-Adressen und Anfragen, um die Sicherheit der Website zu gewÃ¤hrleisten. Die gesammelten Daten werden nur fÃ¼r diesen Zweck verwendet und nach 30 Tagen gelÃ¶scht.
#
#
## Hinweise zur Nutzung des Plugins

> [!Note]
> **ğŸ“¦ Installation**
>    - Lade das Plugin in dein WordPress-Verzeichnis hoch (/wp-content/plugins/).
>    - **Aktiviere** das Plugin im WordPress-Adminbereich unter **Plugins**.
>         - Konfiguration: **Keine** weitere Konfiguration nÃ¶tig â€“ Es gewÃ¤hrleistet die Sicherheit Ihrer Daten.

> [!Note]
> **ğŸ’¡ Hinweise**
>    - Sie werden im Admin-Bereich benachrichtigt, wenn ein Benutzername mit einem angezeigten Namen Ã¼bereinstimmt, um Sie auf potenzielle Sicherheitsrisiken hinzuweisen.
    Blockierte IPs werden nach einem bestimmten Zeitraum automatisch wieder freigegeben.
#
#
## Technische Details
> [!Note]
> **ğŸ“Š Tabellen in der Datenbank**
>   - Das Plugin erstellt zusÃ¤tzliche Tabellen in der WordPress-Datenbank
#
#   
> [!Important]
> **âš“ Hooks und Filter**
>
>    - shutdown: Wird ausgefÃ¼hrt, unmittelbar bevor PHP die AusfÃ¼hrung beendet. ÃœberprÃ¼ft und blendet Benutzernamen aus.
>    - Dieser Hook wird von  shutdown_action_hook() aufgerufen und von register_shutdown_function()  in  als Shutdown-Funktion bei PHP registriert wp-settings.php.
>    - rest_prepare_user: Entfernt Benutzernamen aus REST API Antworten.
>    - template_redirect: Deaktiviert URLs, die Benutzernamen enthalten.

> [!Note]
> **ğŸ§© Links zu den Modulen**
>
>    ğŸ”—[username-enumeration.md](docs/username-enumeration.md)
> 
>    ğŸ”—[badrequest-tracker.md](docs/badrequest-tracker.md)
